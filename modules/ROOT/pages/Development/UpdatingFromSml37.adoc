= Upgrading from SML 3.7.0 to 3.8.x

[NOTE]
====
This page is still a work in progress.

If you have any feedback, please let us know in the Discord.
====

TODO

- update the regular modding guides to use the new Alpakit UI and mention game version stuff
- Update generic updating guide to have a step for bumping game and SML version
- update uplugin fields page with GameVersion dep



[IMPORTANT]
====
The contents of this page will change frequently!
Keep your eyes on the `#modding-info-feed` discord channel to be notified when updates are made.
====

TODO SML3.8 feature summary.

First, please _read this entire page before you begin updating your mod_.
It will save you time later to have an idea going in of what to expect while updating.

After you have finished reading this page,
follow the directions on the
xref:Development/UpdatingToNewVersions.adoc[Updating your Mod]
guide to install the updated engine, starter project, and update your mod.

== The Winds of Change are Blowing

=== Preparing for 1.0

Now is the time to make a backup of your current copy of the game
xref:faq.adoc#PlayOlderVersion[as described in the FAQ]
so you can test mod functionality and extract assets if something you previously referenced is no longer available in 1.0.

[id="SMLNoLongerHardRequired"]
=== Mods No Longer Require a Dependency on SML

Although 99% of mods should still depend on SML for its feature set,
Ficsit.app now supports uploading mods without an SML dependency.
If you think your mod is part of the 1%,
read more on the xref:Development/Satisfactory/ModsWithoutSML.adoc[Modding Without SML] page.

== New Features

=== Session Setting Replication

TODO

SML correctly handles Session Setting replication to multiplayer clients for you now.
Thanks SirDigby and Mircea (TODO who else to credit?) for implementing this.

=== SML Capable of Running Client-Side Only

It is now possible have SML installed on your client even when the server does not have SML installed.
This means you can create client-side mods that work when connected to vanilla servers.
An example of a mod that implements this functionality is https://ficsit.app/mod/InfiniteNudge[Infinite Nudge].

Of course, a number of certain things will not be possible without the server also having SML installed.

=== Gameplay Tags and the SML Extended Attribute Provider

TODO

xref:Development/ModLoader/ExtendedAttributeProvider.adoc[Extended Attribute Provider]

== Not Done Yet

The following features are not quite ready to use yet.
This section will change often, so be sure to come back here and check as you update your mods!

TODO compare below with 3.8 feature set

=== Content Registry Issue with Mod Schematics Depending on Vanilla Schematics

See https://github.com/satisfactorymodding/SatisfactoryModLoader/issues/248[this github issue for more info].
This should not affect the vast majority of mods.

=== Decal_Normal Broken on Modded Parts using Mesh Proxies

Mesh proxies past the first instance may not render correctly.
This is a UE5 issue that Coffee Stain is working with Epic Games to resolve.
You can work around this for the time being by using a default masked material.

=== Advanced Game Settings values not saved

The xref:Development/ModLoader/SessionSettings.adoc[Session Settings] page
explains how you can create your own Advanced Game Settings.
However, their values are not currently saved with the save file.
Session Settings still function correctly - their values are saved.

== Required Changes

In addition to any specific-to-your-mod issues you may encounter,
the changes described below _must_ be made in order for your mod to be updated.

=== Alpakit Changes

Understanding the changes to Alpakit, and the new features added in this update, will help you work efficiently.

==== Alpakit Dev and Alpakit Release Split into Separate Windows

The Alpakit Release functionality (for creating release builds) has been brought into its own window to help with UI readability
and understanding which Alpakit settings are relevant to development time.

You can open the new Alpakit windows via these buttons in Unreal Editor's toolbar or the File dropdown menu.

image:Development/UpdatingGuides/AlpakitButtons38.png[Screenshot of new Alpakit buttons]

==== Launch Game Type: Custom Split into Path and Arguments

If you were previously using
`powershell.exe C:/Git/SF_ModProject/RobWorkingDir/SFLaunch_Advanced.ps1 -branch EXP -loadLatestSave`
you should now use:

* Custom Path: `powershell`
* Custom Launch Args: `C:/Git/SF_ModProject/RobWorkingDir/SFLaunch_Advanced.ps1 -branch EXP -loadLatestSave`

==== New Alpakit Log Feature: Time Since Last Pack

The Alpakit Log now displays the time a last successful pack was completed.
Great for if you started packing something, went to do something else, and came back but can't remember what exactly you started!

[id="Alpakit_GameVersionDependency"]
== Game Version Dependency

Ficsit.app now requires uploaded mods to specify a minimum game version with which the mod is compatible.
The reasoning behind this is explained in link:#SMLNoLongerHardRequired[this section].

Alpakit will warn you in the Alpakit Release window if your mod's game version is older than the project's game version.
Clicking on this warning will automatically update the field for you.

SML will check this game version at runtime,
requiring that the player's game version is greater than or equal to the listed required version.

== Additional Changes

You might not be affected by these changes,
but we'd like to draw extra attention to them.

== Add Special Item Tag to Relevant Items in your Mod

If your mod adds any item descriptors that serves a special non-crafting purpose,
like the Any Undefined, Wildcard, Overflow, and None sorting rule in the base game,
use the xref:Development/ModLoader/ExtendedAttributeProvider.adoc[Extended Attribute Provider]
to add the `SML.Registry.Item.SpecialItemDescriptor` tag to it.
See that page for more information.

== Funchook Improvements

We have switched to our own custom build of Funchook to (hopefully) avoid the
https://github.com/satisfactorymodding/SatisfactoryModLoader/issues/235[rare inconsistent hooking crash issue].
If your mod makes use of hooking (and especially unhooking), watch for any bugs that may arise related to this
and let us know on the discord if you encounter any issues.

== TODO

