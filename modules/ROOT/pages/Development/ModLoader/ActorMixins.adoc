= Actor Mixins

[IMPORTANT]
====
This feature slated for SML 3.11 has not been released yet, and is not in the `dev` branch yet!
The contents of this page will change frequently!
====

Actor Mixins are an extension of the xref:Development/ModLoader/BlueprintHooks.adoc[Blueprint Hook System]
designed to allow adding extra functionality to Unreal Actors.

TODO

https://discord.com/channels/555424930502541343/562722670974599227/1359689865473687766

== Creating an Actor Mixin

Creating a Mixin (formerly known as a SCS Hook) is similar to creating a Blueprint Hook.

Within the Editor, create a new Blueprint of the type "Blueprint Mixin"

image::Development/ModLoader/ActorMixins/CreateMixinAsset.png[]

When creating it you will be given a prompt to choose which Actor to add the Mixin to.
Note that unlike Blueprint Hook assets, each Mixin asset can only have hooks for a single Actor class.

image::Development/ModLoader/ActorMixins/ChooseActor.png[]

Upon opening the Mixin you will be presented with an empty graph. The components of the Actor you are hooking will also be shown.

TODO can you add new components here and have them be added to the actor?

image::Development/ModLoader/ActorMixins/Components.png[]

There are a few functions you can override.

TODO what if you want to override functions from the actor? presumably use the hook graph?

image::Development/ModLoader/ActorMixins/Functions.png[]

If you intend to use "Tick" make sure you check "Enable Mixin Tick". 

image::Development/ModLoader/ActorMixins/EnableTick.png[]

Add your logic.

image::Development/ModLoader/ActorMixins/AddLogic.png[]

[id="Register"]
== Registering the Mixin

Actor Mixins must be registered in a
xref:Development/ModLoader/ModModules.adoc[Game Instance Module] to be applied in-game.
Create a Mod Game Instance Module if you don't already have one and add your new Mixin to the "Blueprint Hooks" array.

image::Development/ModLoader/ActorMixins/RegisterMixin.png[Register Mixin to Game Instance Module]

== Limitations and Workarounds

=== Blueprint Actors Only

The Blueprint Hooks system only works on blueprint-implemented content.
As the Actor Mixin system is an extension of the blueprint hooks system,
it only works on blueprint-implemented actors.
This rarely causes problems as most actors in Satisfactory are blueprint actors backed by {cpp} actor classes.

Notable actors that are not blueprint implemented include:

- The dropped items that spawn as loot around Drop Pods

The closest workaround for {cpp} actors would be hooking begin play,
although that is no longer using the Mixin system.

=== Level Actors and Saved Data

Actors that are spawned and streamed with the level required special handling interally to work with the actor mixin system.
As a consequence of this, SaveGame properties on components added via Mixins to level actors will not be loaded.

To work around this, save this data on something else saved instead, such as a Mod Subsystem.
Data could be associated with each component via a map of soft object references to data structs.
Using a soft reference is important here as the object could potentially be unloaded, leading to null keys in the map.
